<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE elasticMapper SYSTEM "elasticmapping.dtd">
<elasticMapper name="medicine" theme="theme"  desc="导入药物数据" business="md">
    <propertys>
        <!--id字段-->
        <property sourceName="oe_ord_id"  targetName="md_med_id" valueType="String" idField="true"></property>
        <!--关联就诊ID-->
        <property sourceName="admno" targetName="admno" valueType="String" rowKey="true" parentField="true"></property>
        <!--关联登记号-->
        <property sourceName="regno" targetName="regno" valueType="String" routingField="true"></property>
        <!--用药时段-->
        <property sourceName="oe_ord_execdate" targetName="md_med_timeinterval" valueType="String"></property>
        <!--用药 - 医嘱名称-->
        <property sourceName="oe_ord_meddicname" targetName="md_med_name" valueType="String"></property>
        <!--用药商品名称-->
        <property sourceName="oe_ord_meddiccode" targetName="md_med_bisname" valueType="String">
            <dicConvertor methodName="getByCode" dicType="PHCGoods">
                <parameter></parameter>
            </dicConvertor>
        </property>
        <!--用药通用名称-->
        <property sourceName="oe_ord_meddiccode" targetName="md_med_genname" valueType="String">
            <dicConvertor methodName="getByCode" dicType="PHCGeneric">
                <parameter></parameter>
            </dicConvertor>
        </property>
        <!--药物名称（用于统计， 不分词）-->
        <property sourceName="oe_ord_meddiccode" targetName="md_med_gendescname" valueType="String">
            <dicConvertor methodName="getByCode" dicType="PHCGeneric">
                <parameter></parameter>
            </dicConvertor>
        </property>
        <!--药品类别-->
        <property sourceName="oe_ord_orcat" targetName="md_med_category" valueType="String">
        </property>
        <!--单次剂量-->
        <property sourceName="oe_ord_dosage" targetName="md_med_singledose" valueType="String"></property>
        <!--总剂量-->
        <!--<property sourceName="" targetName="Med_TotalDose" valueType="String"></property>-->
        <!--医嘱数量-->
        <property sourceName="oe_ord_orderqty" targetName="md_med_orderqty" valueType="String"></property>
        <!--用药频率-->
        <property sourceName="oe_ord_freq" targetName="md_med_frequency" valueType="String"></property>
        <!--给药开始时间-->
        <property sourceName="oe_ord_starttime" targetName="md_med_starttime" valueType="String"></property>
        <!--给药结束时间-->
        <property sourceName="oe_ord_endtime" targetName="md_med_stoptime" valueType="String"></property>
        <!--用药时长,需要计算-->
        <!--<property sourceName="Ord_StartTime" targetName="Med_Days" valueType="String"></property>-->
        <!--药理学子分类-->
        <!--<property sourceName="ord_code" targetName="Med_PhcSubCat" valueType="String">-->
        <!--<dicConvertor methodName="getByCode" dicType="">-->
        <!--<parameter></parameter>-->
        <!--</dicConvertor>-->
        <!--</property>-->
        <!--药理学大分类-->
        <!--<property sourceName="ord_code" targetName="Med_PhcCat" valueType="String">-->
        <!--<dicConvertor methodName="getByCode" dicType="">-->
        <!--<parameter></parameter>-->
        <!--</dicConvertor>-->
        <!--</property>-->
        <!--医嘱大分类-->
        <property sourceName="oe_ord_orcat" targetName="md_med_ordcat" valueType="String"></property>
    </propertys>
    <filters>
        <targetFilter>
            <must>
                <!-- 用药通用名称不能是空 -->
                <filter filterName="md_med_genname" filterMethod="isNotEmpty"></filter>
            </must>
        </targetFilter>
    </filters>
    <outputs>
        <output>
            <elasticsearch index="csmsearch" type="doc"></elasticsearch>
        </output>
    </outputs>
</elasticMapper>